<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
        <link rel="stylesheet" href="index_style.css" type="text/css">
        <link rel="stylesheet" href="font-awesome.css" type="text/css">
        <title>Khan's Restaurant</title>
    </head>
    <body>
        <!--NavBar-->
        <div class="contrast-setting" id="contrast-menu" style="display: none;">
            <div style="padding: 10px">
                <input class="slider" type="range" max="10" min="0" step="1" value="5" id="contrast-range" onchange="setContrast();">
            </div>
            <div style="padding: 5px">
                <p id="contrast-ratio">50%</p>
            </div>
        </div>
        <nav>
            <span><h1 class="brand">Khan's Restaurant</h1></span>
            <div class="button-group">
                <i class="fas fa-bars"></i><i class="fas fa-cog" onclick="showContrastMenu();"></i>
            </div>
        </nav>
        <!--Order Confirmed Pop-Up-->
        <div class="pop-up" id="pop-up">
            <span><p class="close" onclick="closePopUp();">&times;</p></span>
            <i class="fas fa-exclamation-circle symbol-warning" id="symbol"></i>
            <p class="order" id="order-status"></p>
        </div>
        <div class="container">
            <!--Breakfast Table-->
            <table style="grid-row: 1 / span 3">
                <tr><th colspan="3">Breakfast</th></tr>
                <tr><th>Item</th><th>Half</th><th>Full</th></tr>
                <tr><td>Cheese Omlate</td><td>N/A</td><td onclick="addItem(0, 2, 2);">90</td></tr>
                <tr><td>Special Omlate</td><td>N/A</td><td onclick="addItem(0, 3, 2);">110</td></tr>
                <tr><td>Sunny Side Up</td><td>N/A</td><td onclick="addItem(0, 4, 2);">50</td></tr>
                <tr><td>Pakistani Omlate</td><td>N/A</td><td onclick="addItem(0, 5, 2);">50</td></tr>
                <tr><td>Pakistani Omlate<sub>with cheese</sub></td><td>N/A</td><td onclick="addItem(0, 6, 2);">100</td></tr>
                <tr><td>Pakistani Omlate<sub>with olive</sub></td><td>N/A</td><td onclick="addItem(0, 7, 2);">80</td></tr>
                <tr><td>Tomato Egg</td><td>N/A</td><td onclick="addItem(0, 8, 2);">80</td></tr>
                <tr><td>Special Channa</td><td>N/A</td><td onclick="addItem(0, 9, 2);">60</td></tr>
                <tr><td>Toast</td><td>N/A</td><td onclick="addItem(0, 10, 2);">30</td></tr>
                <tr><td>French Toast</td><td>N/A</td><td onclick="addItem(0, 11, 2);">30</td></tr>
                <tr><td>Qeema</td><td onclick="addItem(0, 12, 1);">89</td><td onclick="addItem(0, 12, 2);">189</td></tr>
                <tr><td>Laccha Paratha</td><td>N/A</td><td onclick="addItem(0, 13, 2);">35</td></tr>
                <tr><td>Paratha</td><td>N/A</td><td onclick="addItem(0, 14, 2);">20</td></tr>
                <tr><td>Paratha Omlate</td><td>N/A</td><td onclick="addItem(0, 15, 2);">110</td></tr>
                <tr><td>Tea</td><td>N/A</td><td onclick="addItem(0, 16, 2);">25</td></tr>
                <tr><td>Green Tea</td><td>N/A</td><td onclick="addItem(0, 17, 2);">25</td></tr>
                <tr><td>Lassi</td><td>N/A</td><td onclick="addItem(0, 18, 2);">80</td></tr>
                <tr><td>Dhai</td><td>N/A</td><td onclick="addItem(0, 19, 2);">50</td></tr>
                <tr><td>Shakes</td><td>N/A</td><td onclick="addItem(0, 20, 2);">99</td></tr>
            </table>
            <!--Muglai Cuisine Table-->
            <table>
                <tr><th colspan="3">Mughlai Cuisine</th></tr>
                <tr><th>Item</th><th>Half</th><th>Full</th></tr>
                <tr><td>Mughlai Handi</td><td onclick="addItem(1, 2, 1);">470</td><td onclick="addItem(1, 2, 2);">869</td></tr>
                <tr><td>Mughlai Chicken</td><td onclick="addItem(1, 3, 1);">430</td><td onclick="addItem(1, 3, 2);">820</td></tr>
                <tr><td>Mughlai Mutton</td><td onclick="addItem(1, 4, 1);">820</td><td onclick="addItem(1, 4, 2);">1399</td></tr>
            </table>
            <!--Salad Table-->
            <table>
                <tr><th colspan="2">Salad</th></tr>
                <tr><th>Item</th><th>Half</th><th>Full</th></tr>
                <tr><td>Salad</td><td>N/A</td><td onclick="addItem(2, 2, 2);">470</td></tr>
                <tr><td>Russian Salad</td><td>N/A</td><td onclick="addItem(2, 3, 2);">430</td></tr>
                <tr><td>Pine Apple Salad</td><td>N/A</td><td onclick="addItem(2, 4, 2);">820</td></tr>
            </table>
            <!--Pakistani Curry Table-->
            <table>
                <tr><th colspan="3">Pakistani Curry</th></tr>
                <tr><th>Item</th><th>Half</th><th>Full</th></tr>
                <tr><td>Daal Mash</td><td onclick="addItem(3, 2, 1);">79</td><td onclick="addItem(3, 2, 2);">179</td></tr>
                <tr><td>Qeema</td><td onclick="addItem(3, 3, 1);">89</td><td onclick="addItem(3, 3, 2);">189</td></tr>
                <tr><td>Sabzi</td><td onclick="addItem(3, 4, 1);">89</td><td onclick="addItem(3, 4, 2);">189</td></tr>
                <tr><td>Chicken Qorma</td><td onclick="addItem(3, 5, 1);">139</td><td onclick="addItem(3, 5, 2);">169</td></tr>
                <tr><td>Lobia</td><td onclick="addItem(3, 6, 1);">30</td><td onclick="addItem(3, 6, 2);">60</td></tr>
                <tr><td>Channa</td><td onclick="addItem(3, 7, 1);">30</td><td onclick="addItem(3, 7, 2);">60</td></tr>
                <tr><td>Haleem</td><td onclick="addItem(3, 8, 1);">89</td><td onclick="addItem(3, 8, 2);">189</td></tr>
            </table>
            <!--Appetizers Table-->
            <table>
                <tr><th colspan="3">Appetizers</th></tr>
                <tr><th>Item</th><th>Half</th><th>Full</th></tr>
                <tr><td>Samosa</td><td>N/A</td><td onclick="addItem(4, 2, 2);">15</td></tr>
                <tr><td>Pakora Plate</td><td onclick="addItem(4, 3, 1);">50</td><td onclick="addItem(4, 3, 2);">100</td></tr>
                <tr><td>Sandwich</td><td>N/A</td><td onclick="addItem(4, 4, 2);">150</td></tr>
                <tr><td>Nuggets</td><td>N/A</td><td onclick="addItem(4, 5, 2);">240</td></tr>
            </table>
            <!--Pakistani Table-->
            <table>
                <tr><th colspan="3">Pakistani</th></tr>
                <tr><th>Item</th><th>Half</th><th>Full</th></tr>
                <tr><td>White Chicken</td><td onclick="addItem(5, 2, 1);">409</td><td onclick="addItem(5, 2, 2);">809</td></tr>
                <tr><td>White Handi</td><td onclick="addItem(5, 3, 1);">469</td><td onclick="addItem(5, 3, 2);">829</td></tr>
                <tr><td>Mutton Karahi</td><td onclick="addItem(5, 4, 1);">789</td><td onclick="addItem(5, 4, 2);">1339</td></tr>
                <tr><td>Beef Tikka Karahi</td><td onclick="addItem(5, 5, 1);">410</td><td onclick="addItem(5, 5, 2);">820</td></tr>
                <tr><td>Chicken Jalfrezi</td><td onclick="addItem(5, 6, 1);">400</td><td onclick="addItem(5, 6, 2);">810</td></tr>
            </table>
            <!--Rice Table-->
            <table>
                <tr><th colspan="3">Rice</th></tr>
                <tr><th>Item</th><th>Half</th><th>Full</th></tr>
                <tr><td>Chicken Biryani</td><td>N/A</td><td onclick="addItem(6, 2, 2);">180</td></tr>
                <tr><td>Savour Pulao</td><td>N/A</td><td onclick="addItem(6, 3, 2);">220</td></tr>
                <tr><td>Chicken Fried Rice</td><td>N/A</td><td onclick="addItem(6, 4, 2);">180</td></tr>
                <tr><td>Vegetable Fried Rice</td><td>N/A</td><td onclick="addItem(6, 5, 2);">130</td></tr>
                <tr><td>Eeg Fried Rice</td><td>N/A</td><td onclick="addItem(6, 6, 2);">140</td></tr>
                <tr><td>Kabli Pulao</td><td>N/A</td><td onclick="addItem(6, 7, 2);">299</td></tr>
            </table>
            <!--BBQ Table-->
            <table>
                <tr><th colspan="3">BBQ</th></tr>
                <tr><th>Item</th><th>Half</th><th>Full</th></tr>
                <tr><td>Chicken Tikka</td><td>N/A</td><td onclick="addItem(7, 2, 2);">150</td></tr>
                <tr><td>Chicken Malai Boti</td><td>N/A</td><td onclick="addItem(7, 3, 2);">420</td></tr>
                <tr><td>Beef Behari Boti</td><td>N/A</td><td onclick="addItem(7, 4, 2);">490</td></tr>
                <tr><td>BBQ Plater</td><td>N/A</td><td onclick="addItem(7, 5, 2);">950</td></tr>
                <tr><td>Fish Tikka</td><td>N/A</td><td onclick="addItem(7, 6, 2);">520</td></tr>
                <tr><td>Seekh Kabab</td><td>N/A</td><td onclick="addItem(7, 7, 2);">620</td></tr>
            </table>
            <!--Dessert Table-->
            <table>
                <tr><th colspan="3">Dessert</th></tr>
                <tr><th>Item</th><th>Half</th><th>Full</th></tr>
                <tr><td>Molten Lava Cake</td><td>N/A</td><td onclick="addItem(8, 2, 2);">130</td></tr>
                <tr><td>Chocolate Cake</td><td>N/A</td><td onclick="addItem(8, 3, 2);">245</td></tr>
                <tr><td>Cup Cake</td><td>N/A</td><td onclick="addItem(8, 4, 2);">70</td></tr>
                <tr><td>Brownies</td><td>N/A</td><td onclick="addItem(8, 5, 2);">70</td></tr>
                <tr><td>Kheer</td><td>N/A</td><td onclick="addItem(8, 6, 2);">70</td></tr>
            </table>
            <!--Shakes Table-->
            <table>
                <tr><th colspan="3">Shakes</th></tr>
                <tr><th>Item</th><th>Half</th><th>Full</th></tr>
                <tr><td>Mango</td><td>N/A</td><td onclick="addItem(9, 2, 2);">99</td></tr>
                <tr><td>Apple</td><td>N/A</td><td onclick="addItem(9, 3, 2);">99</td></tr>
                <tr><td>Banana</td><td>N/A</td><td onclick="addItem(9, 4, 2);">99</td></tr>
                <tr><td>Pine Apple</td><td>N/A</td><td onclick="addItem(9, 5, 2);">100</td></tr>
                <tr><td>Strawberry</td><td>N/A</td><td onclick="addItem(9, 6, 2);">99</td></tr>
            </table>
            <!--Coffee Table-->
            <table>
                <tr><th colspan="3">Coffee</th></tr>
                <tr><th>Item</th><th>Half</th><th>Full</th></tr>
                <tr><td>Cappicino</td><td>N/A</td><td onclick="addItem(10, 2, 2);">120</td></tr>
                <tr><td>Latte</td><td>N/A</td><td onclick="addItem(10, 3, 2);">140</td></tr>
                <tr><td>Black Coffee</td><td>N/A</td><td onclick="addItem(10, 4, 2);">100</td></tr>
                <tr><td>Caremal Coffee</td><td>N/A</td><td onclick="addItem(10, 5, 2);">130</td></tr>
            </table>
            <!--Tandoori Table-->
            <table>
                <tr><th colspan="3">Tandoori</th></tr>
                <tr><th>Item</th><th>Half</th><th>Full</th></tr>
                <tr><td>Special Nan</td><td>N/A</td><td onclick="addItem(11, 2, 2);">25</td></tr>
                <tr><td>Garlic Nan</td><td>N/A</td><td onclick="addItem(11, 3, 2);">40</td></tr>
                <tr><td>Tandoori Nan</td><td>N/A</td><td onclick="addItem(11, 4, 2);">10</td></tr>
                <tr><td>Chappati</td><td>N/A</td><td onclick="addItem(11, 5, 2);">20</td></tr>
            </table>
        </div>
        <div class="container">
            <!--Order List-->
            <table id="order-list" style="grid-column: 1 / 2">
                <tr><th colspan="3">Your Order</th></tr>
                <tr><th>Item Name</th><th>Price</th><th>Quantity</th></tr>
            </table>
            <!--Button Group-->
            <table style="grid-column: 2 / 3">
                <tr><th colspan="3">Controls</th></tr>
                <tr><td onclick="total();">Get Total</td><td onclick="showPopUp();">Confirm</td></tr>
            </table>
            <!--Total Sum-->
            <table style="grid-column: 3 / 4" id="results">
                <tr><th colspan="2">Purchases</th></tr>
            </table>
            <!--Voucher-->
            <table style="grid-column: 4 / 6" id="voucher-table">
                <tr><th colspan="3">Voucher</th></tr>
                <tr><td colspan="2" style="width: 80%"><input type="text" id="voucher-code" class="input-voucher" placeholder="Enter Voucher Code Here"></td><td style="padding: 0px"><button class="apply-btn" id="apply-btn" onclick="addVoucher();">Apply</button></td></tr>
            </table>
        </div>
        <script>
            var voucherValid = false;
            var voucherCodes = ['123','4456','foodie007'];
            
            function addItem(table_index, row_index, cell_index)
            {
                var tab = document.getElementsByTagName('table')[table_index].getElementsByTagName('tr')[row_index].getElementsByTagName('td');
                
                if(!(traversOrderList(table_index, row_index, cell_index)))
                    {
                        var el = document.getElementById('order-list');
                        var row = document.createElement('tr');
                        var index = el.getElementsByTagName('tr').length;
                        var func = 'removeItem(' + index + ')';
                        var another_func = 'checkInputValue(' + index + ')';

                        var cel = document.createElement('td');
                        var text = document.createTextNode(tab[0].innerHTML);
                        cel.appendChild(text);
                        row.appendChild(cel);
                        cel.setAttribute('onclick', func);
                        

                        var cel = document.createElement('td');
                        var text = document.createTextNode(tab[cell_index].innerHTML);
                        tab[cell_index].style.background = "rgba(0, 255, 0, 0.1)";
                        cel.appendChild(text);
                        row.appendChild(cel);

                        var inp = document.createElement('input');
                        inp.setAttribute('type','text');
                        inp.setAttribute('onblur', another_func);
                        inp.value = 1;
                        inp.className = 'input';
                        cell = document.createElement('td');
                        cell.appendChild(inp);
                        row.appendChild(cell);
                        el.appendChild(row);
                    }
            }
            
            function traversOrderList(table_index, row_index, cell_index)
            {
                var order_list = document.getElementById('order-list').getElementsByTagName('tr');
                var new_order = document.getElementsByTagName('table')[table_index].getElementsByTagName('tr')[row_index].getElementsByTagName('td');
                var return_value = false;
                
                for (row = 2; row < order_list.length; row++)
                    {
                        var selected_row = order_list[row].getElementsByTagName('td');
                        if (selected_row[0].innerHTML == new_order[0].innerHTML)
                            {
                                if (selected_row[1].innerHTML == new_order[cell_index].innerHTML)
                                    {
                                        var data = selected_row[2].getElementsByTagName('input')[0];
                                        var quantity = Number(data.value);
                                        quantity += 1;
                                        data.value = quantity;
                                        var pro = (quantity / 10);
                                        new_order[cell_index].style.background = "rgba(0, 255, 0, " + pro + ")";
                                        return_value = true;
                                    }
                            }
                    }
                return return_value;
            }
            
            function total()
            {
                var order_list = document.getElementById('order-list').getElementsByTagName('tr');
                var sum = 0;
                var selected_row;
                var sub_total = 0;
                var price;
                var quantity;
                for (row = 2; row < order_list.length; row++)
                    {
                        selected_row = order_list[row].getElementsByTagName('td');
                        price = selected_row[1].innerHTML;
                        quantity = Number(selected_row[2].getElementsByTagName('input')[0].value);
                        
                        sub_total = price * quantity;
                        sum += sub_total;
                    }
                var ar = ['Total', sum];
                var list = document.getElementById('results');
                var rowNode = document.createElement('tr');
                for (i in ar)
                    {
                        var cell = document.createElement('td');
                        var text = document.createTextNode(ar[i]);
                        cell.appendChild(text);
                        rowNode.appendChild(cell);
                    }
                list.appendChild(rowNode);
                // this area need some work
                voucherDiscount(voucherValid, sum);
                if (voucherValid)
                    {
                        if (list.children.length > 4)
                            {
                                for (var j = 1; j < 4; j++)
                                    {
                                        list.removeChild(list.getElementsByTagName('tr')[1]);
                                    }
                            }
                    }
                else
                    {
                        if (list.children.length > 2)
                            {
                                list.removeChild(list.getElementsByTagName('tr')[1]);
                            }
                    }
            }
            
            function reloadWindow()
            {
                window.location.reload(true);
            }

            function closePopUp()
            {
                document.getElementById('pop-up').style.display = 'none';
                reloadWindow();
            }
            
            function showPopUp()
            {
                var order = document.getElementById('order-list').getElementsByTagName('tr');
                if (order.length <= 2)
                    {
                        document.getElementById('symbol').setAttribute('class','fas fa-exclamation-circle symbol-warning');
                        document.getElementById('order-status').innerHTML = "You haven\'t select ANYTHING";
                    }
                else
                    {
                        document.getElementById('symbol').setAttribute('class','fas fa-check-circle symbol-success');
                        document.getElementById('order-status').innerHTML = "Order Confirmed<br>Order will be ready in 15 - 20 min";
                    }
                document.getElementById('pop-up').style.display = 'grid';
            }
            
            function removeItem(index)
            {
                var el = document.getElementById('order-list');
                var row = el.getElementsByTagName('tr')[index];
                var quantity = row.getElementsByTagName('input')[0].value;
                
                el.removeChild(row);
                
                var cel = el.getElementsByTagName('tr');
                for (i = 2; i < cel.length; i++)
                    {
                        var func = 'removeItem(' + i + ')';
                        var another_func = 'checkInputValue(' + index + ')';
                        cel[i].getElementsByTagName('td')[0].setAttribute('onclick', func);
                        cel[i].getElementsByTagName('td')[2].getElementsByTagName('input')[0].setAttribute('onblur', another_func);
                    }
            }
            
            function checkInputValue(row_index)
            {
                var row = document.getElementById('order-list').getElementsByTagName('tr')[row_index].getElementsByTagName('td')[2].getElementsByTagName('input')[0];
                if (row.value <= 0)
                    {
                        removeItem(row_index);
                    }
            }
            
            function setContrast()
            {
                var slider = document.getElementById('contrast-range').value;
                var result = document.getElementById('contrast-ratio');
                var pop = document.getElementById('pop-up');
                var opacity = (slider / 10);
                result.innerHTML = (opacity * 100) + '%';
                var backcolor = 'rgba(0, 0, 0, ' + opacity + ')';
                pop.style.backgroundColor = backcolor;
                var el = document.getElementsByClassName('container');
                for (i in el)
                    {
                        el[i].style.backgroundColor = backcolor;
                    }
            }
            
            function showContrastMenu()
            {
                var el = document.getElementById('contrast-menu');
                var di = el.style.display;
                if (di == 'none')
                    {
                        el.style.display = 'grid';
                    }
                else if (di == 'grid')
                    {
                        el.style.display = 'none';
                    }   
            }
            
            function addVoucher()
            {
                var btn = document.getElementById('apply-btn');
                var voucherEl = document.getElementById('voucher-code');
                var voucherTab = document.getElementById('voucher-table');
                var voucherRow = document.createElement('tr');
                var voucherCel = document.createElement('td');
                var code = voucherEl.value;
                if (voucherCodes.includes(code))
                    {
                        voucherEl.setAttribute('readonly','true');
                        btn.style.background = '#b8b894';
                        voucherCel.innerHTML = 'Valid Vocuher Code';
                        voucherCel.setAttribute('class', 'voucher-valid');
                        voucherRow.appendChild(voucherCel);
                        voucherTab.appendChild(voucherRow);
                        voucherValid = true;
                    }
                else
                    {
                        voucherCel.innerHTML = 'Invalid Vocuher Code';
                        voucherCel.setAttribute('class', 'voucher-invalid');
                        voucherRow.appendChild(voucherCel);
                        voucherTab.appendChild(voucherRow);
                    }
            }
            
            function voucherDiscount(cond, total)
            {
                var purchaseTable = document.getElementById('results');
                if (cond == true)
                    {
                        var discount = total * (20 / 100);
                        var newTotal = total - discount;
                        var cellData = [
                            ['Discount', discount],
                            ['New Total', newTotal]
                        ];
                        for (var i = 0; i < cellData.length; i++)
                        {
                            var row = document.createElement('tr');
                            for(var j = 0; j < cellData[i].length; j++)
                            {
                                var cell = document.createElement('td');
                                var text = document.createTextNode(cellData[i][j]);
                                cell.appendChild(text);
                                row.appendChild(cell);
                            }
                        purchaseTable.appendChild(row);
                        }
                    }
            }
        </script>
    </body>
</html>